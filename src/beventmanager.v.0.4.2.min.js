/*
    BEventManager - Javascript Custom Event Manager
    version 0.4.2
    21.07.2013
    http://btools.eu
    https://github.com/BTooLs/BEventManager/
 */
(function(){var e=function(){function s(t){if(!t||!t.event||typeof e[t.event]!="undefined"){return false}t=c({},{event:false,triggersLeft:false,before:[],on:[],after:[],cascadeEvent:false},t);if(t.cascadeEvent&&typeof e[t.cascadeEvent]=="undefined"){if(r){s({event:t.cascadeEvent})}else{n&&l("err: cascadeEvent not defined",t.cascadeEvent);return false}}e[t.event]=t;return true}function o(t){e[t]=undefined;try{delete e[t]}catch(n){}for(var r in e){if(e[r].cascadeEvent===t){e[r].cascadeEvent=false}}}function u(i,o){i=c({},{event:false,callId:false,callback:false,thisArg:window,argsArray:[],triggersLeft:false,queueEnd:true,delay:0,timeout:null},i);if(typeof e[i.event]=="undefined"){if(r){s({event:i.event})}else{n&&l("err: event not defined at listener create",i.event);return false}}if(!i.event||typeof i.callback!="function"){n&&l("err: listener/callback not a function",i);return false}if(typeof i.callId==="string"){var u=e[i.event][o].length;for(var a=0;a<u;a++){if(e[i.event][o][a].callId==i.callId){n&&l("err: callId already used for this event/type");return false}}}else{i.callId=t++}if(i.argsArray instanceof Array==false){i.argsArray=[i.argsArray]}if(i.queueEnd){e[i.event][o].push(i)}else{e[i.event][o].unshift(i)}return i.callId}function a(t,r,i){if(e[t]==undefined){n&&l("err: event not exists");return false}n&&l("undefining",t,r,i);var s=e[t][r].length;for(var o=0;o<s;o++){if(e[t][r][o].callId==i){e[t][r].splice(o,1);break}}return true}function f(t,r,s){n&&l("dispatching ",t,r);var o=e[t][r].length;for(var u=0;u<o;u++){(function(){var o=e[t][r][u];if(i||o.delay>0){o.timeout=setTimeout(function(){o.callback.apply(o.thisArg,o.argsArray.concat(s));o.timeout=null;n&&l("calling listener",o.callId);if(typeof o.triggersLeft==="number"){if(--o.triggersLeft<=0){a(t,r,o.callId)}}},o.delay)}else{o.callback.apply(o.thisArg,o.argsArray.concat(s));n&&l("calling listener",o.callId);if(typeof o.triggersLeft==="number"){if(--o.triggersLeft<=0){a(t,r,o.callId)}}}})()}}function l(){if(!console||!typeof console.log=="function")return false;var e=["EventMgr:"].concat(Array.prototype.slice.call(arguments));console.log(e);return true}function c(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=false;if(typeof o==="boolean"){f=o;o=arguments[1]||{};u=2}if(typeof o!=="object"&&!jQuery.isFunction(o)){o={}}if(a===u){o=this;--u}for(;u<a;u++){if((i=arguments[u])!=null){for(r in i){e=o[r];n=i[r];if(o===n){continue}if(f&&n&&(jQuery.isPlainObject(n)||(t=jQuery.isArray(n)))){if(t){t=false;s=e&&jQuery.isArray(e)?e:[]}else{s=e&&jQuery.isPlainObject(e)?e:{}}o[r]=jQuery.extend(f,s,n)}else if(n!==undefined){o[r]=n}}}}return o}var e={};var t=0;var n=false;var r=true;var i=false;this.define=function(){var e=false,t,r;for(var i=0;i<arguments.length;i++){r=arguments[i];if(typeof r=="undefined"||typeof r.event!=="string"){n&&l("err: event name missing");e=false;continue}t={event:r.event};if(typeof r.triggersLeft=="number"&&r.triggersLeft>0||r.triggersLeft===false){t.triggersLeft=r.triggersLeft}if(typeof r.cascadeEvent=="string"||r.cascadeEvent===false){t.cascadeEvent=r.cascadeEvent}e=s(t)}return e};this.eventIsDefined=function(t){return typeof e[t]!=="undefined"};this.undefine=function(e){return o(e)};this.on=function(){if(arguments.length===1){var e=arguments[0]}else if(arguments.length===2){var e={event:arguments[0],callback:arguments[1]}}else{n&&l("err: wrong number of parameters (on)");return false}return u(e,"on")};this.before=function(){if(arguments.length===1){var e=arguments[0]}else if(arguments.length===2){var e={event:arguments[0],callback:arguments[1]}}else{n&&l("err: wrong number of parameters (on)");return false}return u(e,"before")};this.after=function(){if(arguments.length===1){var e=arguments[0]}else if(arguments.length===2){var e={event:arguments[0],callback:arguments[1]}}else{n&&l("err: wrong number of parameters (on)");return false}return u(e,"after")};this.unlisten=function(e,t,r){if(e&&t&&(t==="on"||t=="before"||t=="after")&&typeof r!="undefined"){return a(e,t,r)}n&&l("err: wrong parameters");return false};this.dispatch=function(t,r){if(typeof e[t]=="undefined"){n&&l("err: trigger event not exists",t);return false}n&&l("dispatching ",t);var r=r===undefined?[]:r instanceof Array?r:[r];e[t].before.length&&f(t,"before",r);e[t].on.length&&f(t,"on",r);e[t].after.length&&f(t,"after",r);if(e[t].cascadeEvent){this.dispatch(e[t].cascadeEvent,r)}if(typeof e[t].triggersLeft==="number"&&--e[t].triggersLeft<=0){o(t)}return true};this.setLooseMode=function(e){r=!!e};this.setDebugMode=function(e){n=!!e};this.setDispatchTimeout=function(e){i=!!e};this.eventDebug=function(){return e};this.destroy=function(){e={};t=0};};window.EventManager=e})()